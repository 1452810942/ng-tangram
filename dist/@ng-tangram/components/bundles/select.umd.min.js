!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/cdk/coercion"),require("@angular/cdk/collections"),require("@angular/cdk/overlay"),require("@angular/core"),require("@angular/forms"),require("@ng-tangram/components/core"),require("@ng-tangram/components/forms"),require("rxjs/observable/defer"),require("rxjs/observable/merge"),require("rxjs/operators"),require("rxjs/Subject"),require("@angular/common")):"function"==typeof define&&define.amd?define(["exports","@angular/cdk/coercion","@angular/cdk/collections","@angular/cdk/overlay","@angular/core","@angular/forms","@ng-tangram/components/core","@ng-tangram/components/forms","rxjs/observable/defer","rxjs/observable/merge","rxjs/operators","rxjs/Subject","@angular/common"],t):t((e.nt=e.nt||{},e.nt.components=e.nt.components||{},e.nt.components.select={}),e.ng.cdk.coercion,e.ng.cdk.collections,e.ng.cdk.overlay,e.ng.core,e.ng.forms,e.nt.components.core,e.nt.components.forms,e.Rx.observable.defer,e.Rx.observable.merge,e.Rx.operators,e.Rx.Subject,e.ng.common)}(this,function(e,t,n,o,r,i,l,s,c,a,u,p,h){"use strict";var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};function d(){return Error("Value must be an array in multiple-selection mode.")}function g(){return Error("`ntCompareWith` must be a function.")}var y=function(){return function(e,t){this.source=e,this.value=t}}(),m=function(e){function h(t,n,i,l,s){var h=e.call(this)||this;return h._ngZone=t,h._renderer=n,h._elementRef=i,h._changeDetectorRef=l,h.ngControl=s,h._disabled=!1,h._focused=!1,h._filter=!1,h._state="",h._placeholder="",h._multiple=!1,h._required=!1,h._compareWith=function(e,t){return e===t},h._onChange=function(){},h._onTouched=function(){},h._destroy=new p.Subject,h.selectionChange=new r.EventEmitter,h.valueChange=new r.EventEmitter,h.optionSelectionChanges=c.defer(function(){return h.options?a.merge.apply(void 0,h.options.map(function(e){return e.selectionChange})):h._ngZone.onStable.asObservable().pipe(u.take(1),u.switchMap(function(){return h.optionSelectionChanges}))}),h.origin=new o.OverlayOrigin(i),h.ngControl&&(h.ngControl.valueAccessor=h),h}return function(e,t){function n(){this.constructor=e}f(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(h,e),Object.defineProperty(h.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"triggerValue",{get:function(){return this.empty?"":this._multiple?this._selectionModel.selected.map(function(e){return e.label}).join(", "):this._selectionModel.selected[0].label},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"empty",{get:function(){return!this._selectionModel||this._selectionModel.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"focused",{get:function(){return this._focused},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"disabled",{get:function(){return this._disabled},set:function(e){this._disabled=t.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"required",{get:function(){return this._required},set:function(e){this._required=t.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"multiple",{get:function(){return this._multiple},set:function(e){this._multiple=t.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"filter",{get:function(){return this._filter},set:function(e){this._filter=t.coerceBooleanProperty(e)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"selected",{get:function(){return this.multiple?this._selectionModel.selected:this._selectionModel.selected[0]},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"placeholder",{get:function(){return this.empty?this._placeholder:this.filter?this.triggerValue:this._placeholder},set:function(e){this._placeholder=e},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"compareWith",{set:function(e){if("function"!=typeof e)throw g();this._compareWith=e,this._selectionModel&&this._initializeSelection()},enumerable:!0,configurable:!0}),h.prototype.ngOnInit=function(){this._selectionModel=new n.SelectionModel(this.multiple,void 0,!1)},h.prototype.ngAfterContentInit=function(){var e=this;this.options.changes.pipe(u.startWith(null),u.takeUntil(this._destroy)).subscribe(function(){e._resetOptions(),e._initializeSelection()})},h.prototype.onResize=function(){this._width=this.inputElement.nativeElement.clientWidth},h.prototype.onOpen=function(){var e=this;this._state="folded",this.onResize(),setTimeout(function(){return e._scrollActiveOptionIntoView()})},h.prototype.onClose=function(){this._state="closed",this._onTouched()},h.prototype.onFocus=function(){this.overlay.isOpen||this._disabled||(this.overlay.show(),this._focused=!0)},h.prototype.onBlur=function(){this._focused=!1},h.prototype.focus=function(){this.inputElement.nativeElement.focus()},h.prototype.writeValue=function(e){this.options&&this._setSelectionByValue(e)},h.prototype.registerOnChange=function(e){this._onChange=e},h.prototype.registerOnTouched=function(e){this._onTouched=e},h.prototype.setDisabledState=function(e){this._disabled=e},h.prototype._resetOptions=function(){var e=this,t=a.merge(this.options.changes,this._destroy);this.optionSelectionChanges.pipe(u.takeUntil(t),u.filter(function(e){return e.isUserInput})).subscribe(function(t){e._onSelect(t.source),!e.multiple&&e.overlay.isOpen&&e.overlay.hide()}),a.merge.apply(void 0,this.options.map(function(e){return e.stateChanges})).pipe(u.takeUntil(t)).subscribe(function(){e._changeDetectorRef.markForCheck()})},h.prototype._initializeSelection=function(){var e=this;Promise.resolve().then(function(){e._setSelectionByValue(e.ngControl?e.ngControl.value:e.value),e._scrollActiveOptionIntoView()})},h.prototype._setSelectionByValue=function(e,t){var n=this;if(void 0===t&&(t=!1),this.multiple&&e){if(!Array.isArray(e))throw d();this._clearSelection(),e.forEach(function(e){return n._selectValue(e,t)}),this._sortValues()}else{this._clearSelection();this._selectValue(e,t)}this._changeDetectorRef.markForCheck()},h.prototype._selectValue=function(e,t){var n=this;void 0===t&&(t=!1);var o=this.options.find(function(t){try{return null!=t.value&&n._compareWith(t.value,e)}catch(e){return r.isDevMode()&&console.warn(e),!1}});return o&&(t?o.selectViaInteraction():o.select(),this._selectionModel.select(o)),o},h.prototype._propagateChanges=function(e){var t=null;t=this.multiple?this.selected.map(function(e){return e.value}):this.selected?this.selected.value:e,this._value=t,this.valueChange.emit(t),this._onChange(t),this.selectionChange.emit(new y(this,t)),this._changeDetectorRef.markForCheck()},h.prototype._clearSelection=function(e){this._selectionModel.clear(),this.options.forEach(function(t){t!==e&&t.deselect()})},h.prototype._sortValues=function(){var e=this;this.multiple&&(this._selectionModel.clear(),this.options.forEach(function(t){t.selected&&e._selectionModel.select(t)}))},h.prototype._onSelect=function(e){var t=this._selectionModel.isSelected(e);this.multiple?(this._selectionModel.toggle(e),t?e.deselect():e.select(),this._sortValues()):(this._clearSelection(null==e.value?void 0:e),null==e.value?this._propagateChanges(e.value):this._selectionModel.select(e)),t!==this._selectionModel.isSelected(e)&&this._propagateChanges()},h.prototype._scrollActiveOptionIntoView=function(){var e=null;this.selected instanceof l.NtOptionComponent?e=this.selected:this.selected instanceof Array&&this.selected.length>0&&(e=this.selected[0]),e&&(this.paneElement.nativeElement.scrollTop=e.getOffsetY())},h.prototype.ngOnDestroy=function(){this._destroy.next(),this._destroy.complete()},h.decorators=[{type:r.Component,args:[{selector:"nt-select",template:'<input #inputElement type="text" (focus)="onFocus()" (blur)="onBlur()" (window:resize)="onResize()" [readonly]="!filter" [placeholder]="placeholder" [disabled]="disabled" [value]="filter && focused ? \'\' : triggerValue"> <span class="nt-select-caret"></span> <nt-overlay [origin]="origin" trigger="click" position="bottomLeft" fixed (opened)="onOpen()" (closed)="onClose()"> <div #paneElement class="nt-select-pane" [class.folded]="state === \'folded\'" [style.width.px]="width"> <ng-content></ng-content> </div> </nt-overlay> ',providers:[{provide:l.NT_OPTION_PARENT_COMPONENT,useExisting:h},{provide:s.NtFormFieldControl,useExisting:h}],encapsulation:r.ViewEncapsulation.None,changeDetection:r.ChangeDetectionStrategy.OnPush,host:{class:"nt-select nt-form-control","(resize)":"onResize()","[class.focus]":"overlay.isOpen"}}]}],h.ctorParameters=function(){return[{type:r.NgZone},{type:r.Renderer2},{type:r.ElementRef},{type:r.ChangeDetectorRef},{type:i.NgControl,decorators:[{type:r.Self},{type:r.Optional}]}]},h.propDecorators={disabled:[{type:r.Input}],required:[{type:r.Input}],multiple:[{type:r.Input}],filter:[{type:r.Input}],placeholder:[{type:r.Input}],inputElement:[{type:r.ViewChild,args:["inputElement"]}],paneElement:[{type:r.ViewChild,args:["paneElement"]}],overlay:[{type:r.ViewChild,args:[l.NtOverlayComponent]}],options:[{type:r.ContentChildren,args:[l.NtOptionComponent]}],selectionChange:[{type:r.Output}],valueChange:[{type:r.Output}],compareWith:[{type:r.Input}]},h}(s.NtFormFieldControl),_=function(){function e(){}return e.decorators=[{type:r.NgModule,args:[{imports:[h.CommonModule,l.NtOverlayModule,l.NtOptionModule],exports:[m,l.NtOptionModule],declarations:[m]}]}],e.ctorParameters=function(){return[]},e}();e.NtSelectModule=_,e.getNtSelectDynamicMultipleError=function(){return Error("Cannot change `multiple` mode of select after initialization.")},e.getNtSelectNonArrayValueError=d,e.getNtSelectNonFunctionValueError=g,e.NtSelectChange=y,e.NtSelectComponent=m,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=select.umd.min.js.map
